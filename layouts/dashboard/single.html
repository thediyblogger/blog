{{ $data := index .Site.Data .Site.Language.Lang }}

<!DOCTYPE HTML>
<!--
    Massively by HTML5 UP
    html5up.net | @ajlkn
    Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html lang='{{ .Site.Language.Lang | default "en-us" }}'>
    <head>
        <title>{{ if eq (.Site.Title) (.Title) }}{{ .Site.Title }}{{ else }}{{ .Title }} &middot; {{ .Site.Title }}{{ end }}</title>
        <meta name="description" content="{{ if (.Description) }}{{ .Description }}{{ end }}">
        {{ template "_internal/google_analytics_async.html" . }}

        
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />

         <!-- bootstrap css -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
       

        <link rel="stylesheet" href='{{ "assets/css/main.css" | relURL }}' />
        <link rel="stylesheet" href='{{ "assets/css/dashboard.css" | relURL }}' />
        <noscript><link rel="stylesheet" href='{{ "assets/css/noscript.css" | relURL }}' /></noscript>

        {{ with .Site.Params.favicon }}
        <link rel="shortcut icon" href="{{ . }}">
        {{ end }}


        <script>

            function urlParam(name){
                var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);

                if (results){
                    return results[1];
                }
                else{
                    return false;
                }
            }

            function handleResponse (response) {
              let contentType = response.headers.get('content-type')
              if (contentType.includes('application/json')) {
                return handleJSONResponse(response)
              } else if (contentType.includes('text/html')) {
                return handleTextResponse(response)
              } else {
                // Other response types as necessary. I haven't found a need for them yet though.
                throw new Error(`Sorry, content-type ${contentType} not supported`)
              }
            }

            function handleJSONResponse (response) {
              return response.json()
                .then(json => {
                  if (response.ok) {
                    return json
                  } 
                  else {
                    return Promise.reject(
                        Object.assign(
                            {}, 
                            { "responseBody": json }, 
                            {
                              "status": response.status,
                              "statusText": response.statusText
                            }
                        )
                    )
                  }
                })
            }
            


            function initializePage(){
                // Initialize once with app id
                // PDK.init({ appId: '{{ .Param "pinterest_client_id" }}', cookie: true });
                hideAll();

                if (urlParam('code')) {
                    var code = urlParam('code');
                    window.opener.displaySignup(code);
                    window.close();
                } 

                if (loggedIn()){
                    // if user is logged in,  
                    // user has a complete profile, so run the analysis.
                    $("#loading").show();
                    analyzePinterest();   
                }
                else{
                    // else show the signup intro page
                    $("#signup").show();
                }
            }

            function hideAll(){
                $("#loading").hide();
                $('#signup').hide();
                $('#signupForm').hide();
                $('#loginSection').hide();
                $("#engagementResults").hide();
                $("#boardResults").hide();
                $("#boardPins").hide();

                if (($("#loginModal").data('bs.modal') || {})._isShown){
                    $('#loginModal').modal('hide');
                }
            }

            function signup(){


                var CLIENT_ID = "{{ .Site.Params.pinterest_client_id }}";

                AUTHORIZATION_URL = "https://api.pinterest.com/oauth/" + 
                    "?response_type=code" + 
                    "&client_id=" + CLIENT_ID +
                    "&scope=read_public,write_public" + 
                    "&redirect_uri=" + window.location;

                popup = window.open(
                  AUTHORIZATION_URL,
                  'Sign up with Pinterest',
                  'width=800,height=600'
                )

            }


           

            function displaySignup(code){
                $("#signup").hide();
                $('#signupForm').show();
                $('#signup_code').val(code);
            }

            function submitSignup(){
                // save the users access token for future use
                // session = PDK.getSession();

                // store a permenant access token using this temporary access code
                url = buildEndpoint("/accounts");
                payload = {
                    "email": $('#signup_email').val(),
                    "password": $('#signup_password').val(),
                    "website": $('#signup_website').val(),
                    "pinterest_access_code": $('#signup_code').val()
                }

                // call out to the endpoint to complete the signup
                fetch(
                    url, 
                    {
                        headers: {
                          'Accept': 'application/json',
                          'Content-Type': 'application/json'
                        },
                        method: 'post', 
                        body: JSON.stringify(payload)
                    })
                .then(handleResponse)
                .then(data => storeSession(data))
                .catch(error => displaySignupErrors(error.responseBody))

            }

            function displaySignupErrors(messages){
                console.log(messages);
                console.log("display errors");

                // clear the validation states
                $('#signup_password').removeClass("is-invalid");
                $('#signup_email').removeClass("is-invalid");
                $('#signup_website').removeClass("is-invalid");
                $('.invalid-feedback').remove();

                $('#completeSignupForm').addClass("was-validated");


                $.each(messages, function (i, msg)
                {
                    error_message = $('<div>');
                    error_message.addClass("invalid-feedback");
                    error_message.text(msg['message']);

                    field = msg['field'];

                    if (field == "password"){
                        $('#signup_password').after(error_message);
                        $('#signup_password').addClass("is-invalid");
                    }
                    else if (field == "email"){
                        $('#signup_email').after(error_message);
                        $('#signup_email').addClass("is-invalid");
                    }
                    else if (field == "domain"){
                        $('#signup_website').after(error_message);
                        $('#signup_website').addClass("is-invalid");
                    }
                });
            }

            function storeSession(session){
                // store in the session with the token and expiration
                localStorage.setItem('pinkarma_token', JSON.stringify(session));


                // refresh the page (user is now logged in)
                initializePage();
            }

            function getSession(){
                token = JSON.parse(localStorage.getItem("pinkarma_token"));

                return token;
            }

            function showLogin(){
                hideAll();
                $('#loginSection').show();
            }

            function login(){
                url = buildEndpoint("/auth/login");
                payload = {
                    "email": $('#email').val(),
                    "password": $('#password').val()
                }

                // call out to the endpoint to log in
                fetch(
                    url, 
                    {
                        headers: {
                          'Accept': 'application/json',
                          'Content-Type': 'application/json'
                        },
                        method: 'post', 
                        body: JSON.stringify(payload)
                    })
                .then(handleResponse)
                .then(data => logUserIn(data))
                .catch(error => displayLoginErrors(error.responseBody))
            }

            function logUserIn(data){
                storeSession(data);
            }

            function displayLoginErrors(messages){
                console.log("login error", messages);
                console.log("display errors");

                if (messages){

                    // clear the validation states
                    $('#password').removeClass("is-invalid");
                    $('#email').removeClass("is-invalid");
                    $('.invalid-feedback').remove();

                    $('#loginForm').addClass("was-validated");


                    $.each(messages, function (i, msg)
                    {
                        error_message = $('<div>');
                        error_message.addClass("invalid-feedback");
                        error_message.text(msg['message']);

                        field = msg['field'];

                        if (field == "password"){
                            $('#password').after(error_message);
                            $('#password').addClass("is-invalid");
                        }
                        else if (field == "email"){
                            $('#email').after(error_message);
                            $('#email').addClass("is-invalid");
                        }
                    });
                }
            }


            function logout(){
                // delete the session
                localStorage.removeItem('pinkarma_token');

                // refresh the page
                location.reload(true);
            }

            function loggedIn(){
                return !!getSession();
            }


            function forceRefresh(){
                url = buildEndpoint("/report");
                token = JSON.parse(localStorage.getItem("pinkarma_token")).token

                // call out to the endpoint to get the results
                fetch(
                    url, 
                    {
                        headers: {
                          'Accept': 'application/json',
                          'Content-Type': 'application/json',
                          'Authorization': token
                        },
                        method: 'delete' 
                    })
                .then(function(response){
                    if (response.status == 202) { return response.json() }
                    else if (response.status == 401) { logout(); }
                    else { throw Error(`Request rejected with status ${res.status}`); }
                })
                .then(json => analyze())
                .catch(error => console.error);
            }

            function analyzePinterest(){
                $("#signup").hide();
                $("#engagementResults").hide();
                $("#boardResults").hide();

                // change the login button to logout.
                $('#btnLogin').hide();
                $('#btnFreeTrial').hide();
                $('#btnLogout').show();


                this.analyze();
            }


            function buildEndpoint(path) {
              const endpoint = "{{ .Site.Params.pinkarma_api }}";
              return endpoint + path;
            }

            function analyze(){
                url = buildEndpoint("/report");
                token = JSON.parse(localStorage.getItem("pinkarma_token")).token

                // call out to the endpoint to get the results
                fetch(url, 
                    { 
                        'headers': {
                            'Authorization': token
                        }
                    })
                .then(function(response){
                    if (response.status == 200) { return response.json() }
                    else if (response.status == 401) { logout(); }
                    else { throw Error(`Request rejected with status ${res.status}`); }
                })
                .then(json => renderResults(json))
                .catch(error => console.error);
            }


            function renderResults(report) {
                $('#avatar').attr("src", report.profile.image['60x60']['url'])
                    
                $('#current_score').text(report.engagement_score.score);
                $('#current_score_pct').text(report.engagement_score.percentage);
                $("#badges").empty();

                

                profileName = report.profile.name;

                $('#missionHeader').text(profileName);
                $("#carousel").empty();
                $("#carousel").empty();


                recommendationsElement = $("<div>");
                recommendationsElement.attr("id", "recommendations");
                recommendationsElement.addClass("carousel-inner")

                // render the levels
                carouselitem = $("<div>");
                carouselitem.addClass("carousel-item");
                carouselitem.addClass("active");

                var num_badges_earned = 0;

                //$.each(report.levels, function(level, metrics){
                level_keys = Object.keys(report.levels);
                sorted_levels = level_keys.sort(function(a, b){
                    return report.levels[a].order - report.levels[b].order
                });


                var card_container = $("<div class='container'>");
                var card_row = $("<div class='card-columns'>");

                for (i = 0; i < sorted_levels.length; i++){
                    level = sorted_levels[i];
                    metrics = report.levels[level]
                    level_complete = true;


                    var card_template = $("#hidden-card-recommendation-summary-template").html();
                    var card = $(card_template).clone();

                    $(card).find('.card-title').html(level);

                    $.each(metrics, function (m, a){
                        if (m != "order"){

                            var achieved_template = $("#hidden-card-achieved-template").html();
                            var achieved_row = $(achieved_template).clone()

                            $(achieved_row).find('.metric').html(m)
                            
                            if (a){
                                $(achieved_row).find('.fa').addClass("fa-check")
                                $(achieved_row).addClass("text-muted")
                            }
                            else{
                                $(achieved_row).find('.fa').addClass("fa-times")
                                level_complete = false;
                            }

                            $(card).find('.metriclist').append(achieved_row)
                        }
                    });

                    

                    if (level_complete){
                        num_badges_earned++;
                        // show the badge for this level
                        badge = $("<img>")

                        switch (level){
                            case "Account Basics":
                                src = "/images/badge-account-basics.png";
                                break;
                            case "Group Board Strategy":
                                src = "/images/badge-groupie.png";
                                break;
                            case "Pinning Strategy":
                                src = "/images/badge-strategist-1.png";
                                break;
                            case "Profile SEO":
                                src = "/images/badge-pinterest-seo.png";
                                break;
                            case "Pinning Frequency":
                                src = "/images/badge-strategist-2.png";
                                break;
                            case "Blogging Superstar":
                                src = "/images/badge-superstar.png";
                                break;
                            default:
                                src = "";
                                break;
                        }
                        badge.attr("src", src)

                        $(card).find(".card-footer").append(badge);
                    }
                    else{
                        $(card).find(".card-footer").remove();
                    }

                    card_row.append(card);
                }

                card_container.append(card_row);
                carouselitem.append(card_container);

                

                recommendationsElement.append(carouselitem);

                $("#currentLevel").text("BADGES: " + num_badges_earned);

                



                // render the recommendations
                $.each(report.recommendations, function(index, r){
                    carouselitem = $("<div>");
                    carouselitem.addClass("carousel-item");

                    var card_container = $("<div class='container'>");
                    var card_row = $("<div class='card-deck'>");

                    // render the recommendation summary card
                    var card_template = $("#hidden-card-recommendation-template").html();
                    var card_rec = $(card_template).clone();
                    $(card_rec).find('.card-title').html(r.metric);
                    $(card_rec).find('.hint').html(r.details);
                    $(card_rec).find('.impact').html("<strong>Impact: " + r.impact + "</strong>");
                    $(card_rec).find('.goal').html("<strong>Goal: " + r.level + "</strong>");

                    // learn more button
                    link = $("<a>");
                    link.attr("href", r.link);
                    link.attr("target", "_blank");
                    link.addClass("button");
                    link.text("Learn More");
                    $(card_rec).find('.card-footer').append(link);


                    // render the issues for this metric
                    var card_list_template = $("#hidden-card-recommendation-issues-template").html();
                    var card_examples = $(card_list_template).clone();
                    $(card_examples).find('.card-title').html("Issues Detected");

                    $.each(r.value, function (index, v){
                        var achieved_template = $("#hidden-card-recommendation-issue-template").html();
                        var achieved_row = $(achieved_template).clone()

                        $(achieved_row).find('.metric').html(v.value)
                        $(achieved_row).find('.fa').addClass("fa-times")
                        


                        if (v.examples.length > 0){
                            examples = $("<ul>");

                            $.each(v.examples, function (i, e){
                                li = $("<li>");
                                link = $("<a>");
                                link.attr("href", e.url);
                                link.attr("target", "_blank");
                                link.text(e.text);
                                li.append(link);
                                examples.append(li);
                            });

                            achieved_row.append(examples);
                        }
                            
                        $(card_examples).find('.issues-list').append(achieved_row)
                    });

                    card_row.append(card_examples);
                    card_row.append(card_rec);
                    card_container.append(card_row);
                    carouselitem.append(card_container);
                    recommendationsElement.append(carouselitem);
                });

                $("#carousel").append(recommendationsElement);


                // add buttons for navigating the carousel items
                carouselindicators = $("<div>");
                carouselindicators.addClass("carousel-buttons");
                
                for (i = 0; i < $(".carousel-item").length; i++){
                    button = $("<button>");
                    button.attr("data-target", "#carousel");
                    button.attr("data-slide-to", i);
                    var tooltipText = "Overall Progress";

                    if (i > 0) {
                        tooltipText = report.recommendations[i - 1]["metric"];
                    }

                    button.addClass("small")
                    button.text(i + 1);

                    addTooltip(button, tooltipText, false, "top");

                    if (i == 0){ 
                        button.addClass("active");
                    }

                    carouselindicators.append(button);
                }

                refreshButton = $("<button>");
                refreshButton.addClass("small")
                refreshButton.id = "btnForceRefresh";
                refreshButton.html("<i class='fa fa-refresh'></i>");
                refreshButton.click(forceRefresh);
                addTooltip(refreshButton, "Refresh Data", false, "top");

                carouselindicators.append(refreshButton);

                $("#carousel").prepend(carouselindicators);
                $('#carousel').carousel({interval: 5000});

                var $carouselIndicators = $(".carousel-buttons > button");
                $('#carousel').on('slide.bs.carousel', function(e) {
                      var currentSlideNo = e.to;
                      var newItem = $(".carousel-buttons > button[data-slide-to='" + currentSlideNo + "']");
                      
                      $carouselIndicators.removeClass("active");
                      newItem.addClass("active");
                });



                // render the list of boards
                $("#boardRows").empty();
                sortedboards = report.boards.sort(function(a, b){
                    aName = a.name.toLowerCase();
                    bName = b.name.toLowerCase();
                    
                    return a.counts.collaborators - b.counts.collaborators || (aName < bName ? -1 : (aName > bName ? 1 : 0 )) ;
                })

                var card_row = $("<div class='card-columns'>");
                
                $.each(sortedboards, function (index, board){

                    var card_template = $("#hidden-card-board-template").html();
                    var card = $(card_template).clone();

                    title = $("<span>");
                    title.html("&nbsp;" + board.name);

                    if (board.counts.collaborators > 0){
                        // add a group icon
                        icon = createIcon("fa-group", "Group Board with " + board.counts.collaborators + " collaborators", true);
                        title.prepend(icon);
                    }

                    var checkmark = $("<i class='fa fa-check'>");
                    var timesmark = $("<i class='fa fa-times'>");

                    $(card).find('.title').append(title);
                    $(card).find('.followers').html(board.counts.followers);
                    $(card).find('.pins').html(board.counts.pins);
                    $(card).find('.repins').html(board.counts.repins);
                    $(card).find('.virality').html(board.counts.virality);
                    $(card).find('.engagement').html(board.counts.engagement);

                    if (board.counts.pins < 20) 
                        $(card).find('.pins-fa').addClass("fa-times")
                    else
                        $(card).find('.pins-fa').addClass("fa-check");
                    
                    if (board.counts.repins < board.counts.pins) 
                        $(card).find('.repins-fa').addClass("fa-times")
                    else
                        $(card).find('.repins-fa').addClass("fa-check");

                    if (board.counts.virality < 1) 
                        $(card).find('.virality-fa').addClass("fa-times")
                    else
                        $(card).find('.virality-fa').addClass("fa-check");

                    if (board.counts.engagement < 1) 
                        $(card).find('.engagement-fa').addClass("fa-times")
                    else
                        $(card).find('.engagement-fa').addClass("fa-check");

                    if (board.stats == "in_progress"){
                        // we dont have complete stats yet for the pins.
                        $(card).find('.populating').html("<img data-toggle='tooltip' data-placement='right' src='/images/loading-hz.svg' alt='-' title='Hold Tight.  We are still downloading your data.  Check back in a few hours.' />");

                    }


                    card_row.append(card);

                    /*
                    name_cell = $("<td>");
                    name_element = createTooltip(board.description, true, board.name + " ");
                    name_cell.append(name_element);

                    if (board.scan.length > 0){
                        var warnings = "";
                        var num_warnings = 0;

                        $.each(board.scan, function (index, scan){
                            if (!scan.achieved){

                                warning_icon = $("<i>");
                                warning_icon.attr("class", "fa fa-times");
                                warning_icon.attr("aria-hidden", "true");
                                
                                warning_span = $("<span>");
                                warning_span.html(" " + scan.metric + "<br/>");

                                warning = $("<span>");
                                warning.append(warning_icon);
                                warning.append(warning_span);

                                warnings += warning.prop('outerHTML');
                                num_warnings++;
                            }
                        });

                        if (num_warnings > 0){
                            // add a warning icon
                            icon = createIcon("fa-warning", warnings, true);
                            name_cell.append(icon);
                        }
                    }

                    if (board.counts.collaborators > 0){
                        // add a group icon
                        icon = createIcon("fa-group", "Group Board with " + board.counts.collaborators + " collaborators", true);
                        name_cell.append(icon);
                    }

                    if (board.privacy != "public"){
                        // add a lock icon for secret boards
                        icon = createIcon("fa-lock", "Secret Board", true);
                        name_cell.append(icon);
                    }

                    row = $("<tr>")
                    row.append(name_cell);
                    row.append($("<td>").text(board.counts.pins + " pins"));
                    row.append($("<td>").text(board.counts.followers + " followers"));

                    if (board.stats != "in_progress"){
                        row.append($("<td>").text(board.counts.repins + " repins"));
                        row.append($("<td>").text(board.counts.virality.toFixed(2)));
                        row.append($("<td>").text(board.counts.engagement.toFixed(2)));
                        // row.append($("<td>").text(board.counts.quality.toFixed(0)));
                    }
                    else{
                        // we dont have stats yet for the pins.
                        row.append($("<td colspan='3' class='loading'>").html("<img data-toggle='tooltip' data-placement='right' src='/images/loading-hz.svg' alt='-' title='Hold Tight.  We are still downloading your data.  Check back in a few hours.' />"));
                    }

                    $('#boardRows').append(row);
                    */

                    $('#board-cards').append(card_row);
                });

                $('[data-toggle="tooltip"]').tooltip()

                $("#loading").hide();
                $("#engagementResults").show();
                $("#boardResults").show();

                $("#btnAnalyze").html("Analyze Pinterest");

            }

            function createIcon(icon_class, tooltip_title, is_tooltip_html){
                icon_i = $("<i>");
                icon_i.attr("class", "fa " + icon_class);
                icon_i.attr("aria-hidden", true);

                icon_with_tooltip = createTooltip(tooltip_title, is_tooltip_html, icon_i);
                return icon_with_tooltip;
            }

            function createTooltip(tooltip_title, is_tooltip_html, inner){
                tooltip = $("<span>");
                addTooltip(tooltip, tooltip_title, is_tooltip_html)

                tooltip.append(inner);

                return tooltip;
            }

            function addTooltip(element, tooltip_title, is_tooltip_html, placement="right"){
                element.attr("data-toggle", "tooltip");
                element.attr("data-placement", placement);
                element.attr("data-html", is_tooltip_html);
                element.attr("title", tooltip_title);
            }


           



        </script>

    </head>


    <body lang='{{ .Site.Language.Lang | default "en-us" }}' class="is-loading">

        <!-- Wrapper -->
            <div id="wrapper">

                {{ partial "header" . }}
                {{ partial "nav" . }}

                <!-- Main -->
                    <div id="main">

                        <!-- Scan -->
                        <section id="signup" style="display: none;">
                             <div id="banner" class="row">
                                <div class="col-12">
                                    Join our limited time Early Access Program for free today!
                                </div>
                            </div>
                            <header class="major">
                                <h1><a href="/pinkarma">Pin Karma</a></h1>
                                <p>Your guide to winning on Pinterest and growing traffic to your blog. <a href="/pinkarma">Learn More.</a></p>
                            </header>

                            <div class="row">
                                <div class="col-12">
                                    <button type="button" class="button primary" data-toggle="modal" data-target="#signupModal" onClick="ga('send', 'event', 'Pin Karma Signup', 'Click', 'PinKarma Dashboard');">Join Pin Karma</button>
                                    <!--
                                    <button type="button" class="btn btn-pin" onclick="signup();"><i class="fa fa-pinterest"></i> Sign up With Pinterest</button>
                                    -->
                                    <p>Get Started Free Today</p>
                                    <p>Already a member?  <a href="#" onclick="showLogin(); return false;">Log In now!</a></p>
                                </div>
                            </div>
                        </section>


                        <section id="signupForm" style="display: none;">
                            <form id="completeSignupForm" method="post" action="#">
                                <div class="row">
                                    <div class="col-12">
                                        <h2>Complete Sign Up</h2>
                                    </div>
                                </div>
                                <div class="fields">
                                  <div class="field">
                                    <label for="email" data-toggle="tooltip" data-placement="left" title="We'll never share your email with anyone else.">
                                      Email
                                    </label>
                                    <input type="text" name="email" id="signup_email" placeholder="Your Email Address" required class="is-invalid" />
                                  </div>
                                  <div class="field">
                                    <label for="password" data-toggle="tooltip" data-placement="left" title="Please enter a secure password that is at least 8 characters, contains uppercase and lowercase letters, numbers, and a special character.">Password</label>
                                    <input type="password" name="password" id="signup_password" placeholder="Create a secure password" required/>
                                    <input type="hidden" name="code" id="signup_code" />

                                  </div>
                                  <div class="field">
                                    <label for="website" data-toggle="tooltip" data-placement="left" title="Please enter your website url (e.g. https://www.yourdomain.com).">Website</label>
                                    <input type="text" name="website" id="signup_website" placeholder="https://www.yourdomain.com"  required/>
                                  </div>
                                </div>
                                <ul class="actions">
                                    <li>
                                        <input type="submit" value="Complete Sign Up" name="signup" id="signup_button" class="button" onclick="submitSignup(); return false;">
                                    </li>
                                </ul>
                            </form>
                        </section>


                        <section id="loginSection" style="display: none;">
                            <form id="loginForm" method="post" action="#">
                                <header class="major">
                                    <h1>Pin Karma</h1>
                                    <p>Your guide to winning on Pinterest and growing traffic to your blog.</p>
                                </header>

                                <div class="row">
                                    <div class="col-12">
                                        <h2>Log In</h2>
                                    </div>
                                </div>
                                <div class="row fields">
                                      <div class="field col-6">
                                        <label for="email">Email</label>
                                        <input type="text" name="email" id="email" />
                                      </div>
                                      <div class="field col-6">
                                        <label for="password">Password</label>
                                        <input type="password" name="password" id="password"/>
                                      </div>
                                      <div class="field">
                                        <label>Not yet a member?  <a href="#" onclick="signup(); return false;" >Sign Up today!</a></label>
                                      </div>
                                </div>
                                <ul class="actions">
                                    <li>
                                        <button type="submit" class="button primary" onclick="login(); return false;">Log In</button>
                                    </li>
                                </ul>
                            </form>
                        </section>


                        <section id="loading" style="display: none;">
                            <header class="major">
                                <h1>Pin Karma</h1>
                                <p>Hang tight while we check out your pins.</p>
                            </header>

                            <div class="row">
                                <div class="col-12 icon">
                                    <img src="/images/loading.svg" alt="Loading" />
                                </div>
                            </div>
                        </section>

                        <!-- Engagement -->
                        <section id="engagementResults" style="display: none;">
                            <div class="row">
                                <div id="missions" class="col-12">
                                    <header>
                                        <h2 id="missionHeader"></h2>
                                    </header>
                                    <div id="carousel" class="carousel slide" data-interval="false" data-ride="carousel">
                                        <!-- dynamically populated -->
                                    </div>
                                </div>
                            </div>
                        </section>


                        <!-- Boards -->
                        <section id="boardResults" style="display: none;">
                            <div class="row">
                                <div class="col-12">
                                    <h2>Boards</h2>
                                    <div id="board-cards" class="table-wrapper">
                                        <table class="alt" style="display: none">
                                            <thead>
                                                <tr>
                                                    <th>Board</th>
                                                    <th>Pins</th>
                                                    <th>Followers</th>
                                                    <th>Repins</th>
                                                    <th>
                                                        <span data-toggle="tooltip" data-placement="right" title="Repins / Pin">
                                                            Virality Score
                                                        </span>
                                                    </th>
                                                    <th>
                                                        <span data-toggle="tooltip" data-placement="right" title="Virality / Follower">
                                                            Engagement Score
                                                        </span>
                                                   </th>
                                                   <!--
                                                   <th>
                                                        <span data-toggle="tooltip" data-placement="right" title="SEO vs Engagement vs Broken Pins">
                                                            Quality Score
                                                        </span>
                                                   </th>
                                                    -->
                                                </tr>
                                            </thead>
                                            <tbody id="boardRows">
                                                <!-- dynamically populated rows -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- Pins -->
                        <section id="boardPins" style="display: none;">
                            <div class="row">
                                <div class="col-12">
                                    <h2>Board : Garage Ideas</h2>
                                    <div class="table-wrapper">
                                        <table class="alt">
                                            <thead>
                                                <tr>
                                                    <th>Pin</th>
                                                    <th>Repins</th>
                                                    <th>Keywords</th>
                                                    <th>
                                                        <span data-toggle="tooltip" data-placement="right" title="Keywords, Linked Page SEO, Rich Pins, Optimally sized pin">
                                                            <i class="fa fa-warning" aria-hidden="true"></i> Quality Score
                                                        </span>
                                                   </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>
                                                        <img src="https://i.pinimg.com/564x/2b/91/f8/2b91f80fb3ffa64d2177e2a1db083caf.jpg">
                                                        <span data-toggle="tooltip" data-placement="right" title="When building a new home, there are many builder upgrades available. Some cost more than others and your budget will likely require to choose. Read below for my top 10 builder upgrades you should do, and a few builder upgrades to avoid when building your dream home.">
                                                            drawbuildplay.com
                                                        </span>
                                                        <i class="fa fa-external-link" aria-hidden="true">
                                                    </td>
                                                    <td>18</td>
                                                    <td>lorem ipsum</td>
                                                    <td>
                                                        <span data-toggle="tooltip" data-placement="right" data-html="true"
                                                            title="
                                                                <i class='fa fa-times' aria-hidden='true'></i> Link is invalid<br/>
                                                                <i class='fa fa-times' aria-hidden='true'></i> Going viral<br/>
                                                                <i class='fa fa-times' aria-hidden='true'></i> Keywords found in Pin Title/Desc<br/>
                                                                <i class='fa fa-times' aria-hidden='true'></i> Keywords found in Page Title/Desc<br/>
                                                                <i class='fa fa-times' aria-hidden='true'></i> Pin is a Rich Pin<br/>
                                                                <i class='fa fa-times' aria-hidden='true'></i> Image matches recommended size<br/>
                                                            ">
                                                            <i class="fa fa-warning" aria-hidden="true"></i> 0
                                                        </span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <img src="https://i.pinimg.com/564x/2b/91/f8/2b91f80fb3ffa64d2177e2a1db083caf.jpg">
                                                        <span data-toggle="tooltip" data-placement="right" title="When building a new home, there are many builder upgrades available. Some cost more than others and your budget will likely require to choose. Read below for my top 10 builder upgrades you should do, and a few builder upgrades to avoid when building your dream home.">
                                                            drawbuildplay.com
                                                        </span>
                                                        <i class="fa fa-external-link" aria-hidden="true">
                                                    </td>
                                                    <td>18</td>
                                                    <td>
                                                        <span data-toggle="tooltip" data-placement="right" title="The pin keywords were not found on this board. Consider creating another board targeting these keywords.">
                                                            <i class="fa fa-warning" aria-hidden="true"></i> building a home tips
                                                        </span>
                                                    <td>
                                                        <span data-toggle="tooltip" data-placement="right" data-html="true"
                                                            title="
                                                                <i class='fa fa-check' aria-hidden='true'></i> Link is invalid<br/>
                                                                <i class='fa fa-check' aria-hidden='true'></i> Going viral<br/>
                                                                <i class='fa fa-check' aria-hidden='true'></i> Keywords found in Pin Title/Desc<br/>
                                                                <i class='fa fa-check' aria-hidden='true'></i> Keywords found in Page Title/Desc<br/>
                                                                <i class='fa fa-check' aria-hidden='true'></i> Pin is a Rich Pin<br/>
                                                                <i class='fa fa-check' aria-hidden='true'></i> Image matches recommended size<br/>
                                                            ">
                                                            <i class="fa fa-warning" aria-hidden="true"></i> 0
                                                        </span>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </section> 
                    </div>

                    {{ partial "footer/index" . }}
                    {{ partial "copyright" . }}


            </div>
            {{ template "_internal/google_analytics.html" . }}
            {{ partial "scripts/index" . }}
            {{ partial "signup_pk" . }}


            <script>
                 // initialize the page when document is ready.
                $( document ).ready(function(){
                    initializePage();
                });
            </script>

            <script id="hidden-card-template" type="text/x-custom-template">
                    <div class="card mb-5 mb-lg-5">
                      <div class="card-body">
                        <h5 class="card-title text-muted text-uppercase text-center"></h5>
                        <hr>
                        <ul class="fa-ul metriclist">
                        </ul>
                      </div>
                    </div>
            </script>

            <script id="hidden-card-recommendation-summary-template" type="text/x-custom-template">
                    <div class="card mb-5 mb-lg-5">
                      <div class="card-header">
                          <h5 class="card-title text-muted text-uppercase text-center"></h5>
                      </div>
                      <div class="card-body">
                        <ul class="fa-ul metriclist">
                        </ul>
                      </div>
                      <div class="card-footer badges">

                      </div>
                    </div>
            </script>

            <script id="hidden-card-recommendation-issues-template" type="text/x-custom-template">
                    <div class="card mb-5 mb-lg-5">
                      <div class="card-header">
                          <h5 class="card-title text-muted text-uppercase text-center"></h5>
                      </div>
                      <div class="card-body">
                        <ul class="scrollable issues-list">
                        </ul>
                      </div>
                    </div>
            </script>

            <script id="hidden-card-recommendation-issue-template" type="text/x-custom-template">
                  <li><i class="fa"></i> <span class="metric"></span></li>
            </script>

            <script id="hidden-card-recommendation-template" type="text/x-custom-template">
                    <div class="card mb-5 mb-lg-5">
                      <div class="card-header">
                          <h5 class="card-title text-muted text-uppercase text-center"></h5>
                      </div>
                      <div class="card-body">
                        <p class="goal"></p>
                        <p class="impact"></p>
                        <p class="hint"></p>
                      </div>
                      <div class="card-footer">

                      </div>
                    </div>
            </script>

            <script id="hidden-card-achieved-template" type="text/x-custom-template">
                  <li><span class="fa-li"><i class="fa"></i></span><span class="metric"></span></li>
            </script>

            <script id="hidden-card-board-template" type="text/x-custom-template">
                        <div class="card">
                          <div class="card-header">
                              <h5 class="card-title title text-muted text-uppercase text-center">

                              </h5>
                          </div>
                          <div class="card-body">
                            <ul class="fa-ul metriclist">
                                <li><span class="fa pins-fa"></span> Pins: <span class="pins">1234</span></li>
                                <li><span class="fa repins-fa"></span> Repins: <span class="repins">1</span> <span class="populating"></span> </li>
                                <li><span class="fa virality-fa"></span> Virality: <span class="virality">0.01</span><span class="populating"></span> </li>
                                <li><span class="fa engagement-fa"></span> Engagement: <span class="engagement">2.3</span><span class="populating"></span> </li>
                                <li><span class="fa followers-fa fa-arrow-right"></span> Followers: <span class="followers">123</span></li>
                            </ul>
                          </div>
                        </div>
            </script>


    </body>

</html>
